var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function s(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function l(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function p(){return d(" ")}function m(){return d("")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function b(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function y(t,e,n){t.classList[n?"add":"remove"](e)}let x;function w(t){x=t}function k(t){(function(){if(!x)throw new Error("Function called outside component initialization");return x})().$$.on_mount.push(t)}const _=[],C=[];let E=[];const R=[],A=Promise.resolve();let M=!1;function N(t){E.push(t)}const S=new Set;let j=0;function O(){if(0!==j)return;const t=x;do{try{for(;j<_.length;){const t=_[j];j++,w(t),I(t.$$)}}catch(t){throw _.length=0,j=0,t}for(w(null),_.length=0,j=0;C.length;)C.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];S.has(e)||(S.add(e),e())}E.length=0}while(_.length);for(;R.length;)R.pop()();M=!1,S.clear(),w(t)}function I(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(N)}}const J=new Set;let U;function B(){U={r:0,c:[],p:U}}function P(){U.r||o(U.c),U=U.p}function T(t,e){t&&t.i&&(J.delete(t),t.i(e))}function L(t,e,n,o){if(t&&t.o){if(J.has(t))return;J.add(t),U.c.push((()=>{J.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function z(t,e){L(t,1,1,(()=>{e.delete(t.key)}))}function F(t,e,n,r,c,i,s,l,u,a,f,d){let p=t.length,m=i.length,h=p;const g={};for(;h--;)g[t[h].key]=h;const $=[],v=new Map,b=new Map,y=[];for(h=m;h--;){const t=d(c,i,h),o=n(t);let l=s.get(o);l?r&&y.push((()=>l.p(t,e))):(l=a(o,t),l.c()),v.set(o,$[h]=l),o in g&&b.set(o,Math.abs(h-g[o]))}const x=new Set,w=new Set;function k(t){T(t,1),t.m(l,f),s.set(t.key,t),f=t.first,m--}for(;p&&m;){const e=$[m-1],n=t[p-1],o=e.key,r=n.key;e===n?(f=e.first,p--,m--):v.has(r)?!s.has(o)||x.has(o)?k(e):w.has(r)?p--:b.get(o)>b.get(r)?(w.add(o),k(e)):(x.add(r),p--):(u(n,s),p--)}for(;p--;){const e=t[p];v.has(e.key)||u(e,s)}for(;m;)k($[m-1]);return o(y),$}function D(t){t&&t.c()}function H(t,n,c,i){const{fragment:s,after_update:l}=t.$$;s&&s.m(n,c),i||N((()=>{const n=t.$$.on_mount.map(e).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),l.forEach(N)}function q(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];E.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),E=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(_.push(t),M||(M=!0,A.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function G(e,r,c,i,s,l,u,f=[-1]){const d=x;w(e);const p=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(d?d.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:r.target||d.$$.root};u&&u(p.root);let m=!1;if(p.ctx=c?c(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&s(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),m&&W(e,t)),n})):[],p.update(),m=!0,o(p.before_update),p.fragment=!!i&&i(p.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);p.fragment&&p.fragment.l(t),t.forEach(a)}else p.fragment&&p.fragment.c();r.intro&&T(e.$$.fragment),H(e,r.target,r.anchor,r.customElement),O()}w(d)}class K{$destroy(){q(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}
/*! js-cookie v3.0.1 | MIT */function Y(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}var Q=function t(e,n){function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=Y({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var i in r)r[i]&&(c+="; "+i,!0!==r[i]&&(c+="="+r[i].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+c}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],o={},r=0;r<n.length;r++){var c=n[r].split("="),i=c.slice(1).join("=");try{var s=decodeURIComponent(c[0]);if(o[s]=e.read(i,s),t===s)break}catch(t){}}return t?o[t]:o}},remove:function(t,e){o(t,"",Y({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,Y({},this.attributes,e))},withConverter:function(e){return t(Y({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});function V(t){let e=document.getElementById(t);if(e)return JSON.parse(e.textContent)}function X(t){let e,n;return{c(){e=f("div"),n=d(t[0]),g(e,"class","invalid-feedback")},m(t,o){u(t,e,o),l(e,n)},p(t,e){1&e&&$(n,t[0])},d(t){t&&a(e)}}}function Z(e){let n,r,c,i,s,d,m,$,b,x,w,k,_,C=e[0]&&X(e);return{c(){n=f("form"),r=f("div"),c=f("input"),i=p(),s=f("div"),d=f("input"),m=p(),C&&C.c(),$=p(),b=f("div"),b.innerHTML='<input type="submit" class="btn btn-primary" value="Join"/>',x=p(),w=f("div"),w.innerHTML='<label class="col"><input type="checkbox" name="is_spectator"/> Join as a spectator üëÅÔ∏è</label>',g(c,"type","hidden"),g(c,"name","csrfmiddlewaretoken"),c.value=(console.log(Q.get()),Q.get("csrftoken")),g(d,"type","text"),g(d,"name","name"),g(d,"class","form-control"),y(d,"is-invalid",e[0]),g(s,"class","col"),g(b,"class","col"),g(r,"class","row row-cols-lg-auto"),g(w,"class","row"),g(n,"method","post")},m(t,o){u(t,n,o),l(n,r),l(r,c),l(r,i),l(r,s),l(s,d),v(d,e[1]),l(s,m),C&&C.m(s,null),l(r,$),l(r,b),l(n,x),l(n,w),k||(_=[h(d,"change",e[2]),h(d,"input",e[3])],k=!0)},p(t,[e]){2&e&&d.value!==t[1]&&v(d,t[1]),1&e&&y(d,"is-invalid",t[0]),t[0]?C?C.p(t,e):(C=X(t),C.c(),C.m(s,null)):C&&(C.d(1),C=null)},i:t,o:t,d(t){t&&a(n),C&&C.d(),k=!1,o(_)}}}function tt(t,e,n){let o,r="";k((()=>{const t=new Proxy(new URLSearchParams(window.location.search),{get:(t,e)=>t.get(e)});t.name&&n(1,r=t.name)}));return[o,r,()=>{n(0,o=r?void 0:"Name cannot be empty")},function(){r=this.value,n(1,r)}]}class et extends K{constructor(t){super(),G(this,t,tt,Z,c,{})}}function nt(t){let e,n;const o=t[2].default,r=function(t,e,n,o){if(t){const r=s(t,e,n,o);return t[0](r)}}(o,t,t[1],null);return{c(){e=f("div"),r&&r.c(),g(e,"class","card svelte-10xoif8"),y(e,"isAdmin",t[0])},m(t,o){u(t,e,o),r&&r.m(e,null),n=!0},p(t,[c]){r&&r.p&&(!n||2&c)&&function(t,e,n,o,r,c){if(r){const i=s(e,n,o,c);t.p(i,r)}}(r,o,t,t[1],n?function(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|r[o];return t}return e.dirty|r}return e.dirty}(o,t[1],c,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[1]),null),(!n||1&c)&&y(e,"isAdmin",t[0])},i(t){n||(T(r,t),n=!0)},o(t){L(r,t),n=!1},d(t){t&&a(e),r&&r.d(t)}}}function ot(t,e,n){let{$$slots:o={},$$scope:r}=e,{isAdmin:c}=e;return t.$$set=t=>{"isAdmin"in t&&n(0,c=t.isAdmin),"$$scope"in t&&n(1,r=t.$$scope)},[c,r,o]}class rt extends K{constructor(t){super(),G(this,t,ot,nt,c,{isAdmin:0})}}function ct(t){let e;function n(t,e){return t[1]?lt:st}let o=n(t),r=o(t);return{c(){r.c(),e=m()},m(t,n){r.m(t,n),u(t,e,n)},p(t,c){o===(o=n(t))&&r?r.p(t,c):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&a(e)}}}function it(e){let n;return{c(){n=d("üëÅÔ∏è")},m(t,e){u(t,n,e)},p:t,d(t){t&&a(n)}}}function st(e){let n;return{c(){n=d("‚åõ")},m(t,e){u(t,n,e)},p:t,d(t){t&&a(n)}}}function lt(t){let e,n=t[0].vote+"";return{c(){e=d(n)},m(t,n){u(t,e,n)},p(t,o){1&o&&n!==(n=t[0].vote+"")&&$(e,n)},d(t){t&&a(e)}}}function ut(t){let e;function n(t,e){return t[0].is_spectator?it:t[0].vote?ct:void 0}let o=n(t),r=o&&o(t);return{c(){r&&r.c(),e=m()},m(t,n){r&&r.m(t,n),u(t,e,n)},p(t,c){o===(o=n(t))&&r?r.p(t,c):(r&&r.d(1),r=o&&o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r&&r.d(t),t&&a(e)}}}function at(t){let e,n,o,r,c,i=t[0].name+"";return r=new rt({props:{isAdmin:t[0].is_admin,$$slots:{default:[ut]},$$scope:{ctx:t}}}),{c(){e=f("div"),n=d(i),o=p(),D(r.$$.fragment),g(e,"class","participant svelte-ef8jv9"),b(e,"transform","rotate("+t[2]+"deg) translate(33vw) rotate(90deg)")},m(t,i){u(t,e,i),l(e,n),l(e,o),H(r,e,null),c=!0},p(t,[o]){(!c||1&o)&&i!==(i=t[0].name+"")&&$(n,i);const s={};1&o&&(s.isAdmin=t[0].is_admin),131&o&&(s.$$scope={dirty:o,ctx:t}),r.$set(s),(!c||4&o)&&b(e,"transform","rotate("+t[2]+"deg) translate(33vw) rotate(90deg)")},i(t){c||(T(r.$$.fragment,t),c=!0)},o(t){L(r.$$.fragment,t),c=!1},d(t){t&&a(e),q(r)}}}function ft(t,e,n){let o,r,c,{user:i}=e,{isRevealed:s}=e,{i:l}=e,{count:u}=e;return t.$$set=t=>{"user"in t&&n(0,i=t.user),"isRevealed"in t&&n(1,s=t.isRevealed),"i"in t&&n(3,l=t.i),"count"in t&&n(4,u=t.count)},t.$$.update=()=>{if(120&t.$$.dirty)if(1==u)n(2,c=-90);else{const t=176,e=90,i=t-4;n(6,r=Math.min(i,e+u/8*(i-e))),n(5,o=Math.min(t,135+u/8*(t-135))),n(2,c=l*(r/(u-1))-o)}},[i,s,c,l,u,o,r]}class dt extends K{constructor(t){super(),G(this,t,ft,at,c,{user:0,isRevealed:1,i:3,count:4})}}const pt=[];function mt(e,n=t){let o;const r=new Set;function i(t){if(c(e,t)&&(e=t,o)){const t=!pt.length;for(const t of r)t[1](),pt.push(t,e);if(t){for(let t=0;t<pt.length;t+=2)pt[t][0](pt[t+1]);pt.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(c,s=t){const l=[c,s];return r.add(l),1===r.size&&(o=n(i)||t),c(e),()=>{r.delete(l),0===r.size&&o&&(o(),o=null)}}}}function ht(t,e,n){const o=t.slice();return o[16]=e[n],o}function gt(t,e,n){const o=t.slice();return o[12]=e[n][0],o[19]=e[n][1],o}function $t(t,e,n){const o=t.slice();return o[11]=e[n],o[23]=n,o}function vt(t,e){let n,o,r;return o=new dt({props:{isRevealed:e[0],user:e[11],i:e[23],count:e[2].length}}),{key:t,first:null,c(){n=m(),D(o.$$.fragment),this.first=n},m(t,e){u(t,n,e),H(o,t,e),r=!0},p(t,n){e=t;const r={};1&n&&(r.isRevealed=e[0]),4&n&&(r.user=e[11]),4&n&&(r.i=e[23]),4&n&&(r.count=e[2].length),o.$set(r)},i(t){r||(T(o.$$.fragment,t),r=!0)},o(t){L(o.$$.fragment,t),r=!1},d(t){t&&a(n),q(o,t)}}}function bt(t){let e,n,o=[],r=new Map,c=t[1];const i=t=>t[12];for(let e=0;e<c.length;e+=1){let n=gt(t,c,e),s=i(n);r.set(s,o[e]=wt(s,n))}let s=null;return c.length||(s=yt()),{c(){e=f("div");for(let t=0;t<o.length;t+=1)o[t].c();s&&s.c(),g(e,"class","row")},m(t,r){u(t,e,r);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null);s&&s.m(e,null),n=!0},p(t,n){2&n&&(c=t[1],B(),o=F(o,n,i,1,t,c,r,e,z,wt,null,gt),P(),!c.length&&s?s.p(t,n):c.length?s&&(s.d(1),s=null):(s=yt(),s.c(),s.m(e,null)))},i(t){if(!n){for(let t=0;t<c.length;t+=1)T(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)L(o[t]);n=!1},d(t){t&&a(e);for(let t=0;t<o.length;t+=1)o[t].d();s&&s.d()}}}function yt(e){let n;return{c(){n=f("div"),n.textContent="No votes",g(n,"class","col text-center")},m(t,e){u(t,n,e)},p:t,d(t){t&&a(n)}}}function xt(t){let e,n,o,r,c,i,s=t[12]+"",m=t[19]+"";return{c(){e=f("strong"),n=d(s),o=p(),r=f("span"),c=d(m),i=d("x"),g(r,"class","text-muted")},m(t,s){u(t,e,s),l(e,n),u(t,o,s),u(t,r,s),l(r,c),l(r,i)},p(t,e){2&e&&s!==(s=t[12]+"")&&$(n,s),2&e&&m!==(m=t[19]+"")&&$(c,m)},d(t){t&&a(e),t&&a(o),t&&a(r)}}}function wt(t,e){let n,o,r,c;return o=new rt({props:{$$slots:{default:[xt]},$$scope:{ctx:e}}}),{key:t,first:null,c(){n=f("div"),D(o.$$.fragment),r=p(),g(n,"class","col"),this.first=n},m(t,e){u(t,n,e),H(o,n,null),l(n,r),c=!0},p(t,n){e=t;const r={};16777218&n&&(r.$$scope={dirty:n,ctx:e}),o.$set(r)},i(t){c||(T(o.$$.fragment,t),c=!0)},o(t){L(o.$$.fragment,t),c=!1},d(t){t&&a(n),q(o)}}}function kt(t){let e;return{c(){e=d("You joined as spectator")},m(t,n){u(t,e,n)},d(t){t&&a(e)}}}function _t(t){let e,n,r,c,i,s,m;return{c(){e=f("div"),n=f("button"),r=d("Reveal"),c=p(),i=f("button"),i.textContent="Clear",g(n,"class","btn btn-primary"),n.disabled=t[0],g(i,"class","btn btn-danger"),g(e,"class","btn-group")},m(o,a){u(o,e,a),l(e,n),l(n,r),l(e,c),l(e,i),s||(m=[h(n,"click",t[8]),h(i,"click",t[9])],s=!0)},p(t,e){1&e&&(n.disabled=t[0])},d(t){t&&a(e),s=!1,o(m)}}}function Ct(t){let e,n,o=t[4],r=[];for(let e=0;e<o.length;e+=1)r[e]=Et(ht(t,o,e));return{c(){e=f("div"),n=f("div");for(let t=0;t<r.length;t+=1)r[t].c();g(n,"class","btn-group"),g(e,"class","text-center")},m(t,o){u(t,e,o),l(e,n);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(n,null)},p(t,e){if(4113&e){let c;for(o=t[4],c=0;c<o.length;c+=1){const i=ht(t,o,c);r[c]?r[c].p(i,e):(r[c]=Et(i),r[c].c(),r[c].m(n,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(t){t&&a(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(r,t)}}}function Et(t){let e,n,o,c,i=t[16]+"";return{c(){e=f("button"),n=d(i),g(e,"class","btn btn-secondary"),e.disabled=t[0]},m(i,s){u(i,e,s),l(e,n),o||(c=h(e,"click",(function(){r(t[12](t[16]))&&t[12](t[16]).apply(this,arguments)})),o=!0)},p(o,r){t=o,16&r&&i!==(i=t[16]+"")&&$(n,i),1&r&&(e.disabled=t[0])},d(t){t&&a(e),o=!1,c()}}}function Rt(e){let n,o,r;return{c(){n=f("button"),n.textContent="Add fake users",g(n,"class","btn btn-light")},m(t,c){u(t,n,c),o||(r=h(n,"click",e[10]),o=!0)},p:t,d(t){t&&a(n),o=!1,r()}}}function At(t){let e,n,o,r,c,i,s,d,h,$=[],v=new Map,b=t[2];const y=t=>t[11].id;for(let e=0;e<b.length;e+=1){let n=$t(t,b,e),o=y(n);v.set(o,$[e]=vt(o,n))}let x=t[0]&&bt(t),w=t[3].is_spectator&&kt(),k=t[3].is_admin&&_t(t),_=!t[3].is_spectator&&Ct(t),C="Jieter"==t[3].name&&Rt(t);return{c(){e=f("div");for(let t=0;t<$.length;t+=1)$[t].c();n=p(),o=f("div"),x&&x.c(),r=p(),w&&w.c(),c=p(),k&&k.c(),i=p(),_&&_.c(),s=p(),C&&C.c(),d=m(),g(o,"class","controls svelte-5wgf4k"),g(e,"class","participants svelte-5wgf4k")},m(t,a){u(t,e,a);for(let t=0;t<$.length;t+=1)$[t]&&$[t].m(e,null);l(e,n),l(e,o),x&&x.m(o,null),l(o,r),w&&w.m(o,null),l(o,c),k&&k.m(o,null),u(t,i,a),_&&_.m(t,a),u(t,s,a),C&&C.m(t,a),u(t,d,a),h=!0},p(t,[i]){5&i&&(b=t[2],B(),$=F($,i,y,1,t,b,v,e,z,vt,n,$t),P()),t[0]?x?(x.p(t,i),1&i&&T(x,1)):(x=bt(t),x.c(),T(x,1),x.m(o,r)):x&&(B(),L(x,1,1,(()=>{x=null})),P()),t[3].is_spectator?w||(w=kt(),w.c(),w.m(o,c)):w&&(w.d(1),w=null),t[3].is_admin?k?k.p(t,i):(k=_t(t),k.c(),k.m(o,null)):k&&(k.d(1),k=null),t[3].is_spectator?_&&(_.d(1),_=null):_?_.p(t,i):(_=Ct(t),_.c(),_.m(s.parentNode,s)),"Jieter"==t[3].name?C?C.p(t,i):(C=Rt(t),C.c(),C.m(d.parentNode,d)):C&&(C.d(1),C=null)},i(t){if(!h){for(let t=0;t<b.length;t+=1)T($[t]);T(x),h=!0}},o(t){for(let t=0;t<$.length;t+=1)L($[t]);L(x),h=!1},d(t){t&&a(e);for(let t=0;t<$.length;t+=1)$[t].d();x&&x.d(),w&&w.d(),k&&k.d(),t&&a(i),_&&_.d(t),t&&a(s),C&&C.d(t),t&&a(d)}}}function Mt(t,e,n){let o,r,c,s;const l=V("websocket_url"),{user:u,participants:a,isRevealed:f,choices:d,update:p}=function(t){const e=mt([]),n=mt([]),o=mt(!1),r=mt({});let c;const i=()=>{c=new WebSocket(t),c.onclose=()=>{console.log("WebSocket connection closed unexpectedly. Trying to reconnect in 2s..."),setTimeout((()=>{console.log("Reconnecting..."),i()}),2e3)},c.onmessage=t=>{const c=JSON.parse(t.data);switch(console.log("message",c),c.type){case"init":e.set(c.users),n.set(c.choices),r.set(c.user);break;case"join":e.update((t=>[...t,c.user]));break;case"leave":e.update((t=>{let e;return t.forEach(((t,n)=>{t.name==c.name&&(e=n)})),t.splice(e,1),t}));break;case"reveal":o.set(!0);break;case"clear":o.set(!1),e.update((t=>(t.map((t=>(t.vote=null,t))),t)));break;case"vote":e.update((t=>(t.forEach((t=>{t.id==c.user_id&&(t.vote=c.value)})),[...t])))}}};return i(),{participants:e,isRevealed:o,user:r,choices:n,update:async function(t,e=undefined){(e=e||{}).action=t,console.log("update",e),c.send(JSON.stringify(e))}}}(l);i(t,u,(t=>n(3,c=t))),i(t,a,(t=>n(2,r=t))),i(t,f,(t=>n(0,o=t))),i(t,d,(t=>n(4,s=t)));let m;return t.$$.update=()=>{1&t.$$.dirty&&n(1,m=function(){const t=new Proxy({},{get:(t,e)=>e in t?t[e]:0});return r.forEach((e=>{null!=e.vote&&(t[e.vote]+=1)})),Object.entries(t).sort(((t,e)=>e[1]-t[1]))}())},[o,m,r,c,s,a,f,d,()=>p("reveal"),()=>p("clear"),function(){a.update((t=>{const e=t=>t[Math.floor(Math.random()*t.length)];var n,o;return[...t,{id:(n=1e4,o=2e4,Math.floor(Math.random()*(o-n)+n)),name:e(["Bob","Charlie","Erin","Felix","Gude","Henri","Irma","June","Kevin"]),vote:e(["1","2"])}]}))},u,t=>()=>{o||p("vote",{value:t})}]}class Nt extends K{constructor(t){super(),G(this,t,Mt,At,c,{})}}function St(t){let e,n;return e=new et({}),{c(){D(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function jt(t){let e,n;return e=new Nt({}),{c(){D(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Ot(e){let n,o,r,c,i,s,l,d,m;const h=[jt,St],$=[];return r=function(t,e){return t[0]?0:1}(e),c=$[r]=h[r](e),{c(){n=f("h1"),n.textContent="Planning poker",o=p(),c.c(),i=p(),s=f("br"),l=p(),d=f("a"),d.textContent="New poker session",g(d,"href","/")},m(t,e){u(t,n,e),u(t,o,e),$[r].m(t,e),u(t,i,e),u(t,s,e),u(t,l,e),u(t,d,e),m=!0},p:t,i(t){m||(T(c),m=!0)},o(t){L(c),m=!1},d(t){t&&a(n),t&&a(o),$[r].d(t),t&&a(i),t&&a(s),t&&a(l),t&&a(d)}}}function It(t){return[V("websocket_url")]}return new class extends K{constructor(t){super(),G(this,t,It,Ot,c,{})}}({target:document.querySelector("#poker")})}();
