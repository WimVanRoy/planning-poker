var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,...n){if(null==e){for(const t of n)t(void 0);return t}const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function s(t,e,n){t.$$.on_destroy.push(i(e,n))}function l(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function h(){return g(" ")}function m(){return g("")}function v(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e){e=""+e,t.data!==e&&(t.data=e)}function b(t,e){t.value=null==e?"":e}function x(t,e,n,o){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function k(t,e,n){t.classList.toggle(e,!!n)}let w;function _(t){w=t}function S(t){(function(){if(!w)throw new Error("Function called outside component initialization");return w})().$$.on_mount.push(t)}function C(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const N=[],O=[];let E=[];const A=[],R=Promise.resolve();let W=!1;function J(t){E.push(t)}const M=new Set;let j=0;function I(){if(0!==j)return;const t=w;do{try{for(;j<N.length;){const t=N[j];j++,_(t),P(t.$$)}}catch(t){throw N.length=0,j=0,t}for(_(null),N.length=0,j=0;O.length;)O.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];M.has(e)||(M.add(e),e())}E.length=0}while(N.length);for(;A.length;)A.pop()();W=!1,M.clear(),_(t)}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}const z=new Set;let G;function X(){G={r:0,c:[],p:G}}function B(){G.r||o(G.c),G=G.p}function T(t,e){t&&t.i&&(z.delete(t),t.i(e))}function L(t,e,n,o){if(t&&t.o){if(z.has(t))return;z.add(t),G.c.push((()=>{z.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function F(t){return void 0!==t?.length?t:Array.from(t)}function U(t,e){L(t,1,1,(()=>{e.delete(t.key)}))}function D(t,e,n,r,c,i,s,l,a,u,d,f){let p=t.length,g=i.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const v=[],$=new Map,y=new Map,b=[];for(h=g;h--;){const t=f(c,i,h),o=n(t);let l=s.get(o);l?r&&b.push((()=>l.p(t,e))):(l=u(o,t),l.c()),$.set(o,v[h]=l),o in m&&y.set(o,Math.abs(h-m[o]))}const x=new Set,k=new Set;function w(t){T(t,1),t.m(l,d),s.set(t.key,t),d=t.first,g--}for(;p&&g;){const e=v[g-1],n=t[p-1],o=e.key,r=n.key;e===n?(d=e.first,p--,g--):$.has(r)?!s.has(o)||x.has(o)?w(e):k.has(r)?p--:y.get(o)>y.get(r)?(k.add(o),w(e)):(x.add(r),p--):(a(n,s),p--)}for(;p--;){const e=t[p];$.has(e.key)||a(e,s)}for(;g;)w(v[g-1]);return o(b),v}function H(t){t&&t.c()}function q(t,n,c){const{fragment:i,after_update:s}=t.$$;i&&i.m(n,c),J((()=>{const n=t.$$.on_mount.map(e).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),s.forEach(J)}function V(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];E.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),E=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Y(t,e){-1===t.$$.dirty[0]&&(N.push(t),W||(W=!0,R.then(I)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,r,c,i,s,l,a=null,u=[-1]){const f=w;_(e);const p=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(f?f.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:r.target||f.$$.root};a&&a(p.root);let g=!1;if(p.ctx=c?c(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&s(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),g&&Y(e,t)),n})):[],p.update(),g=!0,o(p.before_update),p.fragment=!!i&&i(p.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();r.intro&&T(e.$$.fragment),q(e,r.target,r.anchor),I()}_(f)}class Q{$$=void 0;$$set=void 0;$destroy(){V(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}
/*! js-cookie v3.0.5 | MIT */
function Z(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");var tt=function t(e,n){function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=Z({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var i in r)r[i]&&(c+="; "+i,!0!==r[i]&&(c+="="+r[i].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+c}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],o={},r=0;r<n.length;r++){var c=n[r].split("="),i=c.slice(1).join("=");try{var s=decodeURIComponent(c[0]);if(o[s]=e.read(i,s),t===s)break}catch(t){}}return t?o[t]:o}},remove:function(t,e){o(t,"",Z({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,Z({},this.attributes,e))},withConverter:function(e){return t(Z({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});function et(t){let e=document.getElementById(t);if(e)return JSON.parse(e.textContent)}function nt(t){let e,n;return{c(){e=p("div"),n=g(t[2]),$(e,"class","invalid-feedback")},m(t,o){u(t,e,o),a(e,n)},p(t,e){4&e&&y(n,t[2])},d(t){t&&d(e)}}}function ot(e){let n,r,c,i,s,l,f,m,y,x,w,_,S,C,N,O,E,A,R,W,J=e[2]&&nt(e);return{c(){n=p("h1"),n.textContent="Planning poker",r=h(),c=p("form"),i=p("div"),s=p("input"),l=h(),f=p("div"),m=p("input"),y=h(),J&&J.c(),x=h(),w=p("div"),w.innerHTML='<input type="submit" class="btn btn-primary" value="Join"/>',_=h(),S=p("div"),C=p("label"),N=p("input"),O=g(" Join as a spectator 👁️"),E=h(),A=p("span"),A.textContent="You can always enable voting later",$(s,"type","hidden"),$(s,"name","csrfmiddlewaretoken"),s.value=tt.get("csrftoken"),$(m,"type","text"),$(m,"name","name"),$(m,"class","form-control"),k(m,"is-invalid",e[2]),$(f,"class","col"),$(w,"class","col"),$(i,"class","row row-cols-lg-auto"),$(N,"type","checkbox"),$(N,"name","is_spectator"),$(C,"class","col"),$(A,"class","text-muted"),$(S,"class","row"),$(c,"method","post")},m(t,o){u(t,n,o),u(t,r,o),u(t,c,o),a(c,i),a(i,s),a(i,l),a(i,f),a(f,m),b(m,e[0]),a(f,y),J&&J.m(f,null),a(i,x),a(i,w),a(c,_),a(c,S),a(S,C),a(C,N),N.checked=e[1],a(C,O),a(S,E),a(S,A),R||(W=[v(m,"change",e[3]),v(m,"input",e[4]),v(N,"change",e[5])],R=!0)},p(t,[e]){1&e&&m.value!==t[0]&&b(m,t[0]),4&e&&k(m,"is-invalid",t[2]),t[2]?J?J.p(t,e):(J=nt(t),J.c(),J.m(f,null)):J&&(J.d(1),J=null),2&e&&(N.checked=t[1])},i:t,o:t,d(t){t&&(d(n),d(r),d(c)),J&&J.d(),R=!1,o(W)}}}function rt(t,e,n){let o,r="",c=null;S((()=>{const t=localStorage.getItem("name");t&&n(0,r=t);const e=localStorage.getItem("isSpectator");null!==e&&n(1,c="true"===e)}));return t.$$.update=()=>{1&t.$$.dirty&&r&&localStorage.setItem("name",r),2&t.$$.dirty&&null!=c&&localStorage.setItem("isSpectator",c?"true":"false")},[r,c,o,()=>{n(2,o=r?void 0:"Name cannot be empty")},function(){r=this.value,n(0,r)},function(){c=this.checked,n(1,c)}]}class ct extends Q{constructor(t){super(),K(this,t,rt,ot,c,{})}}function it(t){let e,n,r,c;const i=t[5].default,s=function(t,e,n,o){if(t){const r=l(t,e,n,o);return t[0](r)}}(i,t,t[4],null);return{c(){e=p("div"),s&&s.c(),$(e,"class","card btn svelte-inppn9"),x(e,"background-color",t[2]||"#d8f7ec"),$(e,"disabled",t[0]),$(e,"role","button"),$(e,"tabindex","0"),k(e,"selected",t[1])},m(o,i){u(o,e,i),s&&s.m(e,null),t[8](e),n=!0,r||(c=[v(e,"click",t[6]),v(e,"keypress",t[7])],r=!0)},p(t,[o]){s&&s.p&&(!n||16&o)&&function(t,e,n,o,r,c){if(r){const i=l(e,n,o,c);t.p(i,r)}}(s,i,t,t[4],n?function(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|r[o];return t}return e.dirty|r}return e.dirty}(i,t[4],o,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[4]),null),(!n||4&o)&&x(e,"background-color",t[2]||"#d8f7ec"),(!n||1&o)&&$(e,"disabled",t[0]),(!n||2&o)&&k(e,"selected",t[1])},i(t){n||(T(s,t),n=!0)},o(t){L(s,t),n=!1},d(n){n&&d(e),s&&s.d(n),t[8](null),r=!1,o(c)}}}function st(t,e,n){let o,{$$slots:r={},$$scope:c}=e,{disabled:i=!0}=e,{selected:s=""}=e,{color:l=null}=e;return t.$$set=t=>{"disabled"in t&&n(0,i=t.disabled),"selected"in t&&n(1,s=t.selected),"color"in t&&n(2,l=t.color),"$$scope"in t&&n(4,c=t.$$scope)},t.$$.update=()=>{10&t.$$.dirty&&o&&s&&o.blur()},[i,s,l,o,c,r,function(e){C.call(this,t,e)},function(e){C.call(this,t,e)},function(t){O[t?"unshift":"push"]((()=>{o=t,n(3,o)}))}]}class lt extends Q{constructor(t){super(),K(this,t,st,it,c,{disabled:0,selected:1,color:2})}}const at=[];function ut(e,n=t){let o;const r=new Set;function i(t){if(c(e,t)&&(e=t,o)){const t=!at.length;for(const t of r)t[1](),at.push(t,e);if(t){for(let t=0;t<at.length;t+=2)at[t][0](at[t+1]);at.length=0}}}function s(t){i(t(e))}return{set:i,update:s,subscribe:function(c,l=t){const a=[c,l];return r.add(a),1===r.size&&(o=n(i,s)||t),c(e),()=>{r.delete(a),0===r.size&&o&&(o(),o=null)}}}}function dt(e,n,c){const s=!Array.isArray(e),l=s?[e]:e;if(!l.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=n.length<2;return u=(e,c)=>{let u=!1;const d=[];let f=0,p=t;const g=()=>{if(f)return;p();const o=n(s?d[0]:d,e,c);a?e(o):p=r(o)?o:t},h=l.map(((t,e)=>i(t,(t=>{d[e]=t,f&=~(1<<e),u&&g()}),(()=>{f|=1<<e}))));return u=!0,g(),function(){o(h),p(),u=!1}},{subscribe:ut(c,u).subscribe};var u}const ft=ut([]),pt=ut([]),gt=ut([]),ht=ut(!1),mt=ut("tshirt"),vt=ut(!1),$t=ut({}),yt=ut(void 0),bt=ut([]),xt=dt(ft,(t=>{const e=new Proxy({},{get:(t,e)=>e in t?t[e]:0});return t.forEach((t=>{null!=t.vote&&(e[t.vote]+=1)})),Object.entries(e).sort(((t,e)=>e[1]-t[1]))})),kt=dt(ft,(t=>t.every((t=>t.is_spectator||t.vote)))),wt=t=>{$t.update((e=>(e.vote=t,e)))};let _t;function St(t,e=void 0){_t&&1==_t.readyState?((e=e||{}).action=t,console.log("update",e),_t.send(JSON.stringify(e))):console.log("Socket not open yet")}function Ct(t){_t=new WebSocket(t),_t.onclose=()=>{yt.set("WebSocket connection closed unexpectedly. Trying to reconnect in 2s..."),setTimeout((()=>{console.log("Reconnecting..."),Ct(t)}),2e3)},_t.onopen=()=>{St({action:"init"})},_t.onmessage=t=>{const e=JSON.parse(t.data);switch(console.log("message",e),e.type){case"init":ft.set(e.users),$t.set(e.user),pt.set(e.settings.choices),ht.set(e.settings.auto_reveal),vt.set(e.settings.is_revealed),gt.set(e.settings.decks),mt.set(e.settings.deck),bt.set(e.log),yt.set(void 0);break;case"vote":ft.update((t=>(t.forEach((t=>{t.id==e.user_id&&(t.vote=e.value)})),[...t])));break;case"error":yt.set(e.message)}}}const Nt=()=>St("reveal"),Ot=()=>{wt(null),St("clear")};function Et(t){return()=>{(function(t){let e;return i(t,(t=>e=t))(),e})(vt)||(St("vote",{value:t}),wt(t))}}function At(t,e,n){const o=t.slice();return o[14]=e[n],o}function Rt(t){let e,n,o,r,c,i,s,l,f=t[14].time+"",m=t[14].event+"",v=JSON.stringify(t[14].data)+"";return{c(){e=p("div"),n=p("span"),o=g(f),r=h(),c=g(m),i=h(),s=g(v),l=h()},m(t,d){u(t,e,d),a(e,n),a(n,o),a(e,r),a(e,c),a(e,i),a(e,s),a(e,l)},p(t,e){16&e&&f!==(f=t[14].time+"")&&y(o,f),16&e&&m!==(m=t[14].event+"")&&y(c,m),16&e&&v!==(v=JSON.stringify(t[14].data)+"")&&y(s,v)},d(t){t&&d(e)}}}function Wt(e){let n,r,c,i,s,l,m,b,x,k,w,_,S,C,N,O,E,A,R,W,J,M,j,I,P=JSON.stringify(e[0])+"",z=JSON.stringify(e[1])+"",G=JSON.stringify(e[2])+"",X=JSON.stringify(e[3])+"",B=!e[5]&&function(t){let e,n,r,c,i;return{c(){e=p("button"),e.textContent="Add fake users",n=h(),r=p("button"),r.textContent="Add fake votes",$(e,"class","btn btn-xs btn-warning"),$(r,"class","btn btn-xs btn-warning")},m(o,s){u(o,e,s),u(o,n,s),u(o,r,s),c||(i=[v(e,"click",t[12]),v(r,"click",t[13])],c=!0)},d(t){t&&(d(e),d(n),d(r)),c=!1,o(i)}}}(e),T=F(e[4]),L=[];for(let t=0;t<T.length;t+=1)L[t]=Rt(At(e,T,t));return{c(){n=p("div"),r=p("div"),c=p("div"),i=g("debug"),s=p("code"),l=g(P),m=h(),b=p("div"),x=g("votes: "),k=p("code"),w=g(z),_=h(),S=p("div"),C=g("user: "),N=p("code"),O=g(G),E=h(),A=p("div"),R=g("participants: "),W=p("code"),J=g(X),M=h(),B&&B.c(),j=h(),I=p("div");for(let t=0;t<L.length;t+=1)L[t].c();$(r,"class","col"),$(I,"class","col"),$(n,"class","row bg-light rounded p-2 small")},m(t,e){u(t,n,e),a(n,r),a(r,c),a(c,i),a(c,s),a(s,l),a(r,m),a(r,b),a(b,x),a(b,k),a(k,w),a(r,_),a(r,S),a(S,C),a(S,N),a(N,O),a(r,E),a(r,A),a(A,R),a(A,W),a(W,J),a(r,M),B&&B.m(r,null),a(n,j),a(n,I);for(let t=0;t<L.length;t+=1)L[t]&&L[t].m(I,null)},p(t,[e]){if(1&e&&P!==(P=JSON.stringify(t[0])+"")&&y(l,P),2&e&&z!==(z=JSON.stringify(t[1])+"")&&y(w,z),4&e&&G!==(G=JSON.stringify(t[2])+"")&&y(O,G),8&e&&X!==(X=JSON.stringify(t[3])+"")&&y(J,X),16&e){let n;for(T=F(t[4]),n=0;n<T.length;n+=1){const o=At(t,T,n);L[n]?L[n].p(o,e):(L[n]=Rt(o),L[n].c(),L[n].m(I,null))}for(;n<L.length;n+=1)L[n].d(1);L.length=T.length}},i:t,o:t,d(t){t&&d(n),B&&B.d(),f(L,t)}}}function Jt(t,e,n){let o,r,c,i,l,a,u,d,f,p,g;s(t,ht,(t=>n(6,r=t))),s(t,vt,(t=>n(7,c=t))),s(t,pt,(t=>n(8,i=t))),s(t,gt,(t=>n(9,l=t))),s(t,mt,(t=>n(10,a=t))),s(t,yt,(t=>n(11,u=t))),s(t,xt,(t=>n(1,d=t))),s(t,$t,(t=>n(2,f=t))),s(t,ft,(t=>n(3,p=t))),s(t,bt,(t=>n(4,g=t)));const h=!window.location.host.includes("localhost");return t.$$.update=()=>{4032&t.$$.dirty&&n(0,o={error:u,deck:a,decks:l,choices:i,isRevealed:c,autoReveal:r})},[o,d,f,p,g,h,r,c,i,l,a,u,()=>St("add_fakes"),()=>St("fake_votes")]}mt.subscribe((t=>St("settings",{deck:t}))),ht.subscribe((t=>St("settings",{auto_reveal:t})));class Mt extends Q{constructor(t){super(),K(this,t,Jt,Wt,c,{})}}function jt(t){let e;function n(t,e){return t[1]?zt:Pt}let o=n(t),r=o(t);return{c(){r.c(),e=m()},m(t,n){r.m(t,n),u(t,e,n)},p(t,c){o===(o=n(t))&&r?r.p(t,c):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&d(e),r.d(t)}}}function It(e){let n;return{c(){n=g("👁️")},m(t,e){u(t,n,e)},p:t,d(t){t&&d(n)}}}function Pt(e){let n;return{c(){n=g("⌛")},m(t,e){u(t,n,e)},p:t,d(t){t&&d(n)}}}function zt(t){let e,n=t[0].vote+"";return{c(){e=g(n)},m(t,n){u(t,e,n)},p(t,o){1&o&&n!==(n=t[0].vote+"")&&y(e,n)},d(t){t&&d(e)}}}function Gt(t){let e;function n(t,e){return t[0].is_spectator?It:t[0].vote?jt:void 0}let o=n(t),r=o&&o(t);return{c(){r&&r.c(),e=m()},m(t,n){r&&r.m(t,n),u(t,e,n)},p(t,c){o===(o=n(t))&&r?r.p(t,c):(r&&r.d(1),r=o&&o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&d(e),r&&r.d(t)}}}function Xt(t){let e,n,o,r,c,i,s=t[0].name+"";return c=new lt({props:{color:t[0].is_spectator?"#effbf7":void 0,$$slots:{default:[Gt]},$$scope:{ctx:t}}}),{c(){e=p("div"),n=p("strong"),o=g(s),r=h(),H(c.$$.fragment),$(e,"class","participant svelte-10w4gcr"),x(e,"transform","rotate("+t[2]+"deg) translate(37.5vw) rotate(90deg)")},m(t,s){u(t,e,s),a(e,n),a(n,o),a(e,r),q(c,e,null),i=!0},p(t,[n]){(!i||1&n)&&s!==(s=t[0].name+"")&&y(o,s);const r={};1&n&&(r.color=t[0].is_spectator?"#effbf7":void 0),35&n&&(r.$$scope={dirty:n,ctx:t}),c.$set(r),(!i||4&n)&&x(e,"transform","rotate("+t[2]+"deg) translate(37.5vw) rotate(90deg)")},i(t){i||(T(c.$$.fragment,t),i=!0)},o(t){L(c.$$.fragment,t),i=!1},d(t){t&&d(e),V(c)}}}function Bt(t,e,n){let o,{user:r}=e,{isRevealed:c}=e,{i:i}=e,{count:s}=e;return t.$$set=t=>{"user"in t&&n(0,r=t.user),"isRevealed"in t&&n(1,c=t.isRevealed),"i"in t&&n(3,i=t.i),"count"in t&&n(4,s=t.count)},t.$$.update=()=>{28&t.$$.dirty&&(n(2,o=-90),s>1&&n(2,o-=Math.min(20,174/s)*(i-(s-1)/2)))},[r,c,o,i,s]}class Tt extends Q{constructor(t){super(),K(this,t,Bt,Xt,c,{user:0,isRevealed:1,i:3,count:4})}}function Lt(t,e,n){const o=t.slice();return o[8]=e[n][0],o[9]=e[n][1],o}function Ft(t){let e,n,o,r,c,i,s,l,f,m,x,k=!1,w=t[9]+"";return f=function(t){let e;return{p(...n){e=n,e.forEach((e=>t.push(e)))},r(){e.forEach((e=>t.splice(t.indexOf(e),1)))}}}(t[6][0]),{c(){e=p("input"),c=h(),i=p("label"),s=g(w),$(e,"type","radio"),$(e,"class","btn-check"),e.__value=n=t[8],b(e,e.__value),$(e,"autocomplete","off"),$(e,"id",o="deck-"+t[8]),e.disabled=r=!t[1],$(i,"class","btn btn-outline-primary svelte-1y9hivi"),$(i,"for",l="deck-"+t[8]),f.p(e)},m(n,o){u(n,e,o),e.checked=e.__value===t[2],u(n,c,o),u(n,i,o),a(i,s),m||(x=v(e,"change",t[5]),m=!0)},p(t,c){1&c&&n!==(n=t[8])&&(e.__value=n,b(e,e.__value),k=!0),1&c&&o!==(o="deck-"+t[8])&&$(e,"id",o),2&c&&r!==(r=!t[1])&&(e.disabled=r),(k||5&c)&&(e.checked=e.__value===t[2]),1&c&&w!==(w=t[9]+"")&&y(s,w),1&c&&l!==(l="deck-"+t[8])&&$(i,"for",l)},d(t){t&&(d(e),d(c),d(i)),f.r(),m=!1,x()}}}function Ut(t){let e;function n(t,e){return!t[1]&&t[4]?Ht:Dt}let o=n(t),r=o(t);return{c(){r.c(),e=m()},m(t,n){r.m(t,n),u(t,e,n)},p(t,c){o!==(o=n(t))&&(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&d(e),r.d(t)}}}function Dt(t){let e;return{c(){e=p("div"),e.textContent="~",$(e,"class","voting-status svelte-1y9hivi"),$(e,"title","Voting in progress")},m(t,n){u(t,e,n)},d(t){t&&d(e)}}}function Ht(t){let e;return{c(){e=p("div"),e.textContent="✓",$(e,"class","voting-status svelte-1y9hivi"),$(e,"title","Voting complete")},m(t,n){u(t,e,n)},d(t){t&&d(e)}}}function qt(t){let e,n,o;return{c(){e=p("button"),e.textContent="Reveal",$(e,"class","btn btn-sm btn-primary svelte-1y9hivi")},m(t,r){u(t,e,r),n||(o=v(e,"click",Nt),n=!0)},d(t){t&&d(e),n=!1,o()}}}function Vt(t){let e,n,o;return{c(){e=p("button"),e.textContent="Clear",$(e,"class","btn btn-sm btn-warning svelte-1y9hivi")},m(t,r){u(t,e,r),n||(o=v(e,"click",Ot),n=!0)},d(t){t&&d(e),n=!1,o()}}}function Yt(e){let n,o,r,c,i,s,l,m,y,b,x,k=F(e[0]),w=[];for(let t=0;t<k.length;t+=1)w[t]=Ft(Lt(e,k,t));let _=!e[3]&&Ut(e);function S(t,e){return t[1]?Vt:qt}let C=S(e),N=C(e);return{c(){n=p("div"),o=p("div");for(let t=0;t<w.length;t+=1)w[t].c();r=g("\n     \n\n    "),_&&_.c(),c=h(),N.c(),i=h(),s=p("div"),l=p("label"),l.textContent="Auto reveal",m=h(),y=p("input"),$(o,"class","btn-group btn-group-sm"),$(o,"role","group"),$(o,"aria-label","Change deck"),$(l,"for","autoReveal"),$(l,"class","svelte-1y9hivi"),$(y,"type","checkbox"),$(y,"class","form-check-input"),$(y,"id","autoReveal"),$(s,"class","form-check form-switch mt-1 ms-3"),$(n,"class","d-flex justify-content-center m-3")},m(t,d){u(t,n,d),a(n,o);for(let t=0;t<w.length;t+=1)w[t]&&w[t].m(o,null);a(n,r),_&&_.m(n,null),a(n,c),N.m(n,null),a(n,i),a(n,s),a(s,l),a(s,m),a(s,y),y.checked=e[3],b||(x=v(y,"change",e[7]),b=!0)},p(t,[e]){if(7&e){let n;for(k=F(t[0]),n=0;n<k.length;n+=1){const r=Lt(t,k,n);w[n]?w[n].p(r,e):(w[n]=Ft(r),w[n].c(),w[n].m(o,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=k.length}t[3]?_&&(_.d(1),_=null):_?_.p(t,e):(_=Ut(t),_.c(),_.m(n,c)),C!==(C=S(t))&&(N.d(1),N=C(t),N&&(N.c(),N.m(n,i))),8&e&&(y.checked=t[3])},i:t,o:t,d(t){t&&d(n),f(w,t),_&&_.d(),N.d(),b=!1,x()}}}function Kt(t,e,n){let o,r,c,i,l;s(t,gt,(t=>n(0,o=t))),s(t,vt,(t=>n(1,r=t))),s(t,mt,(t=>n(2,c=t))),s(t,ht,(t=>n(3,i=t))),s(t,kt,(t=>n(4,l=t)));return[o,r,c,i,l,function(){c=this.__value,mt.set(c)},[[]],function(){i=this.checked,ht.set(i)}]}class Qt extends Q{constructor(t){super(),K(this,t,Kt,Yt,c,{})}}const Zt=(t,e={})=>{xe(e);let{colors:n=["#FFC700","#FF0000","#2E3191","#41BBC7"],duration:o=3500,force:r=.5,particleCount:c=150,particleShape:i="mix",particleSize:s=12,destroyAfterDone:l=!0,stageHeight:a=800,stageWidth:u=1600}=e;!function(t){const e=ue("style");e.dataset.neoconfetti="",e.textContent='@keyframes fk9XWG_y-axis{to{transform:translate3d(0,var(--stage-height),0)}}@keyframes fk9XWG_x-axis{to{transform:translate3d(var(--x-landing-point),0,0)}}@keyframes fk9XWG_rotation{50%{transform:rotate3d(var(--half-rotation),180deg)}to{transform:rotate3d(var(--rotation),360deg)}}.fk9XWG_container{width:0;height:0;z-index:1200;position:relative;overflow:visible}.fk9XWG_particle{animation:x-axis var(--duration-chaos)forwards cubic-bezier(var(--x1),var(--x2),var(--x3),var(--x4));animation-name:fk9XWG_x-axis}.fk9XWG_particle>div{animation:y-axis var(--duration-chaos)forwards cubic-bezier(var(--y1),var(--y2),var(--y3),var(--y4));width:var(--width);height:var(--height);animation-name:fk9XWG_y-axis;position:absolute;top:0;left:0}.fk9XWG_particle>div:before{height:100%;width:100%;content:"";background-color:var(--bgcolor);animation:rotation var(--rotation-duration)infinite linear;border-radius:var(--border-radius);animation-name:fk9XWG_rotation;display:block}',de(document.head,e)}(),t.classList.add("fk9XWG_container"),t.style.setProperty("--stage-height",a+"px");let d,f=fe(c,n),p=te(t,f);function g(t,e){const n=le(se()*(ve-1)),c="rectangles"!==i&&("circles"===i||$e(n)),l=(e,n)=>t.style.setProperty(e,n+"");l("--x-landing-point",ge(ie(he(e,90)-180),0,180,-u/2,u/2)+"px"),l("--duration-chaos",o-le(1e3*se())+"ms");const a=se()<oe?pe(se()*re,2):0;l("--x1",a),l("--x2",-1*a),l("--x3",a),l("--x4",pe(ie(ge(ie(he(e,90)-180),0,180,-1,1)),4)),l("--y1",pe(se()*ce,4)),l("--y2",pe(se()*r*(me()?1:-1),4)),l("--y3",ce),l("--y4",pe(ae(ge(ie(e-180),0,180,r,-r),0),4)),l("--width",(c?s:le(4*se())+s/2)+"px"),l("--height",(c?s:le(2*se())+s)+"px");const d=n.toString(2).padStart(3,"0").split("");l("--half-rotation",d.map((t=>+t/2+""))),l("--rotation",d),l("--rotation-duration",pe(se()*(ne-ee)+ee)+"ms"),l("--border-radius",c?"50%":0)}for(const[t,e]of Object.entries(p))g(e,f[+t].degree);return Promise.resolve().then((()=>d=setTimeout((()=>l&&(t.innerHTML="")),o))),{update(e){xe(e);const g=e.particleCount??c,h=e.colors??n,m=e.stageHeight??a;if(f=fe(g,h),g===c&&JSON.stringify(n)!==JSON.stringify(h))for(const[t,{color:e}]of Object.entries(f))p[+t].style.setProperty("--bgcolor",e);g!==c&&(t.innerHTML="",p=te(t,f)),l&&!e.destroyAfterDone&&clearTimeout(d),t.style.setProperty("--stage-height",m+"px"),n=h,o=e.duration??o,r=e.force??r,c=g,i=e.particleShape??i,s=e.particleSize??s,l=e.destroyAfterDone??l,a=m,u=e.stageWidth??u},destroy(){clearTimeout(d)}}};function te(t,e=[]){const n=[];for(const{color:o}of e){const e=ue("div");e.className="fk9XWG_particle",e.style.setProperty("--bgcolor",o);const r=ue("div");de(e,r),de(t,e),n.push(e)}return n}const ee=200,ne=800,oe=.1,re=.3,ce=.5,ie=Math.abs,se=Math.random,le=Math.round,ae=Math.max,ue=t=>document.createElement(t),de=(t,e)=>t.appendChild(e),fe=(t,e)=>Array.from({length:t},((n,o)=>({color:e[o%e.length],degree:360*o/t}))),pe=(t,e=2)=>le((t+Number.EPSILON)*10**e)/10**e,ge=(t,e,n,o,r)=>(t-e)*(r-o)/(n-e)+o,he=(t,e)=>t+e>360?t+e-360:t+e,me=()=>se()>.5,ve=6,$e=t=>1!==t&&me(),ye=t=>void 0===t,be=(t,e)=>{if(!ye(t)&&Number.isSafeInteger(t)&&t<0)throw new Error(e+" must be a positive integer")},xe=({particleCount:t,duration:e,colors:n,particleSize:o,force:r,stageHeight:c,stageWidth:i,particleShape:s})=>{if(be(t,"particleCount"),be(e,"duration"),be(o,"particleSize"),be(r,"force"),be(c,"stageHeight"),be(i,"stageWidth"),!ye(s)&&!/^(mix|circles|rectangles)$/i.test(s))throw new Error('particlesShape should be either "mix" or "circles" or "rectangle"');if(!ye(n)&&!Array.isArray(n))throw new Error("colors must be an array of strings");if(r>1)throw new Error("force must be within 0 and 1")};function ke(t,e,n){const o=t.slice();return o[1]=e[n][0],o[2]=e[n][1],o}function we(e){let n,o,c;return{c(){n=p("div")},m(e,i){var s;u(e,n,i),o||(s=Zt.call(null,n),c=s&&r(s.destroy)?s.destroy:t,o=!0)},d(t){t&&d(n),o=!1,c()}}}function _e(e){let n;return{c(){n=p("div"),n.textContent="No votes",$(n,"class","col text-center p-2")},m(t,e){u(t,n,e)},p:t,d(t){t&&d(n)}}}function Se(t){let e,n=t[1]+"";return{c(){e=g(n)},m(t,n){u(t,e,n)},p(t,o){1&o&&n!==(n=t[1]+"")&&y(e,n)},d(t){t&&d(e)}}}function Ce(t,e){let n,o,r,c,i,s,l,f,m=e[2]+"";return o=new lt({props:{$$slots:{default:[Se]},$$scope:{ctx:e}}}),{key:t,first:null,c(){n=p("div"),H(o.$$.fragment),r=h(),c=p("div"),i=g(m),s=g("x"),l=h(),$(c,"class","text-muted"),$(n,"class","d-inline-block text-center m-2"),this.first=n},m(t,e){u(t,n,e),q(o,n,null),a(n,r),a(n,c),a(c,i),a(c,s),a(n,l),f=!0},p(t,n){e=t;const r={};33&n&&(r.$$scope={dirty:n,ctx:e}),o.$set(r),(!f||1&n)&&m!==(m=e[2]+"")&&y(i,m)},i(t){f||(T(o.$$.fragment,t),f=!0)},o(t){L(o.$$.fragment,t),f=!1},d(t){t&&d(n),V(o)}}}function Ne(t){let e,n,o,r=[],c=new Map,i=t[0]&&1==t[0].length&&t[0][0][1]>1&&we(),s=F(t[0]);const l=t=>t[1];for(let e=0;e<s.length;e+=1){let n=ke(t,s,e),o=l(n);c.set(o,r[e]=Ce(o,n))}let a=null;return s.length||(a=_e()),{c(){i&&i.c(),e=h(),n=p("div");for(let t=0;t<r.length;t+=1)r[t].c();a&&a.c(),$(n,"class","summary rounded mb-3 text-center svelte-2nvyci")},m(t,c){i&&i.m(t,c),u(t,e,c),u(t,n,c);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(n,null);a&&a.m(n,null),o=!0},p(t,[o]){t[0]&&1==t[0].length&&t[0][0][1]>1?i||(i=we(),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),1&o&&(s=F(t[0]),X(),r=D(r,o,l,1,t,s,c,n,U,Ce,null,ke),B(),!s.length&&a?a.p(t,o):s.length?a&&(a.d(1),a=null):(a=_e(),a.c(),a.m(n,null)))},i(t){if(!o){for(let t=0;t<s.length;t+=1)T(r[t]);o=!0}},o(t){for(let t=0;t<r.length;t+=1)L(r[t]);o=!1},d(t){t&&(d(e),d(n)),i&&i.d(t);for(let t=0;t<r.length;t+=1)r[t].d();a&&a.d()}}}function Oe(t,e,n){let{votes:o}=e;return t.$$set=t=>{"votes"in t&&n(0,o=t.votes)},[o]}class Ee extends Q{constructor(t){super(),K(this,t,Oe,Ne,c,{votes:0})}}function Ae(t,e,n){const o=t.slice();return o[8]=e[n],o}function Re(t,e,n){const o=t.slice();return o[11]=e[n],o[13]=n,o}function We(t){let e,n,o;return{c(){e=p("div"),n=p("div"),o=g(t[1]),$(n,"class","alert alert-danger"),$(n,"role","alert"),$(e,"class","fixed-top")},m(t,r){u(t,e,r),a(e,n),a(n,o)},p(t,e){2&e&&y(o,t[1])},d(t){t&&d(e)}}}function Je(t,e){let n,o,r;return o=new Tt({props:{isRevealed:e[3],user:e[11],i:e[13],count:e[2].length}}),{key:t,first:null,c(){n=m(),H(o.$$.fragment),this.first=n},m(t,e){u(t,n,e),q(o,t,e),r=!0},p(t,n){e=t;const r={};8&n&&(r.isRevealed=e[3]),4&n&&(r.user=e[11]),4&n&&(r.i=e[13]),4&n&&(r.count=e[2].length),o.$set(r)},i(t){r||(T(o.$$.fragment,t),r=!0)},o(t){L(o.$$.fragment,t),r=!1},d(t){t&&d(n),V(o,t)}}}function Me(t){let e,n,o;return n=new Ee({props:{votes:t[4]}}),{c(){e=p("div"),H(n.$$.fragment),$(e,"class","controls svelte-7horpp")},m(t,r){u(t,e,r),q(n,e,null),o=!0},p(t,e){const o={};16&e&&(o.votes=t[4]),n.$set(o)},i(t){o||(T(n.$$.fragment,t),o=!0)},o(t){L(n.$$.fragment,t),o=!1},d(t){t&&d(e),V(n)}}}function je(t){let e,n,o=F(t[6]),r=[];for(let e=0;e<o.length;e+=1)r[e]=ze(Ae(t,o,e));const c=t=>L(r[t],1,1,(()=>{r[t]=null}));return{c(){e=p("div");for(let t=0;t<r.length;t+=1)r[t].c();$(e,"class","d-flex justify-content-center")},m(t,o){u(t,e,o);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null);n=!0},p(t,n){if(104&n){let i;for(o=F(t[6]),i=0;i<o.length;i+=1){const c=Ae(t,o,i);r[i]?(r[i].p(c,n),T(r[i],1)):(r[i]=ze(c),r[i].c(),T(r[i],1),r[i].m(e,null))}for(X(),i=o.length;i<r.length;i+=1)c(i);B()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)T(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)L(r[t]);n=!1},d(t){t&&d(e),f(r,t)}}}function Ie(e){let n,o,r,c,i,s;return{c(){n=g("You joined as spectator."),o=p("br"),r=g("\n                I want to\n                "),c=p("button"),c.textContent="become a voter",$(c,"class","btn btn-light btn-sm")},m(t,l){u(t,n,l),u(t,o,l),u(t,r,l),u(t,c,l),i||(s=v(c,"click",e[7]),i=!0)},p:t,i:t,o:t,d(t){t&&(d(n),d(o),d(r),d(c)),i=!1,s()}}}function Pe(t){let e,n,o=t[8]+"";return{c(){e=g(o),n=h()},m(t,o){u(t,e,o),u(t,n,o)},p(t,n){64&n&&o!==(o=t[8]+"")&&y(e,o)},d(t){t&&(d(e),d(n))}}}function ze(t){let e,n;return e=new lt({props:{disabled:t[3],selected:t[8]==t[5].vote,$$slots:{default:[Pe]},$$scope:{ctx:t}}}),e.$on("click",(function(){r(Et(t[8]))&&Et(t[8]).apply(this,arguments)})),e.$on("keypress",(function(){r(Et(t[8]))&&Et(t[8]).apply(this,arguments)})),{c(){H(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},p(n,o){t=n;const r={};8&o&&(r.disabled=t[3]),96&o&&(r.selected=t[8]==t[5].vote),16448&o&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Ge(t){let e,n;return e=new Mt({}),{c(){H(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Xe(t){let e,n,o,r,c,i,s,l,f,g,v,y,b,x,k,w=[],_=new Map,S=t[1]&&We(t),C=F(t[2]);const N=t=>t[11].id;for(let e=0;e<C.length;e+=1){let n=Re(t,C,e),o=N(n);_.set(o,w[e]=Je(o,n))}let O=t[3]&&Me(t);const E=[Ie,je],A=[];function R(t,e){return t[5].is_spectator?0:1}l=R(t),f=A[l]=E[l](t),y=new Qt({});let W=t[0]&&Ge();return{c(){S&&S.c(),e=h(),n=p("div");for(let t=0;t<w.length;t+=1)w[t].c();o=h(),O&&O.c(),r=h(),c=p("div"),i=p("div"),s=p("div"),f.c(),g=h(),v=p("div"),H(y.$$.fragment),b=h(),W&&W.c(),x=m(),$(n,"class","participants svelte-7horpp"),$(s,"class","col"),$(i,"class","row"),$(v,"class","row"),$(c,"class","container text-center")},m(t,d){S&&S.m(t,d),u(t,e,d),u(t,n,d);for(let t=0;t<w.length;t+=1)w[t]&&w[t].m(n,null);a(n,o),O&&O.m(n,null),u(t,r,d),u(t,c,d),a(c,i),a(i,s),A[l].m(s,null),a(c,g),a(c,v),q(y,v,null),u(t,b,d),W&&W.m(t,d),u(t,x,d),k=!0},p(t,[r]){t[1]?S?S.p(t,r):(S=We(t),S.c(),S.m(e.parentNode,e)):S&&(S.d(1),S=null),12&r&&(C=F(t[2]),X(),w=D(w,r,N,1,t,C,_,n,U,Je,o,Re),B()),t[3]?O?(O.p(t,r),8&r&&T(O,1)):(O=Me(t),O.c(),T(O,1),O.m(n,null)):O&&(X(),L(O,1,1,(()=>{O=null})),B());let c=l;l=R(t),l===c?A[l].p(t,r):(X(),L(A[c],1,1,(()=>{A[c]=null})),B(),f=A[l],f?f.p(t,r):(f=A[l]=E[l](t),f.c()),T(f,1),f.m(s,null)),t[0]?W?1&r&&T(W,1):(W=Ge(),W.c(),T(W,1),W.m(x.parentNode,x)):W&&(X(),L(W,1,1,(()=>{W=null})),B())},i(t){if(!k){for(let t=0;t<C.length;t+=1)T(w[t]);T(O),T(f),T(y.$$.fragment,t),T(W),k=!0}},o(t){for(let t=0;t<w.length;t+=1)L(w[t]);L(O),L(f),L(y.$$.fragment,t),L(W),k=!1},d(t){t&&(d(e),d(n),d(r),d(c),d(b),d(x)),S&&S.d(t);for(let t=0;t<w.length;t+=1)w[t].d();O&&O.d(),A[l].d(),V(y),W&&W.d(t)}}}function Be(t,e,n){let o,r,c,i,l,a;s(t,yt,(t=>n(1,o=t))),s(t,ft,(t=>n(2,r=t))),s(t,vt,(t=>n(3,c=t))),s(t,xt,(t=>n(4,i=t))),s(t,$t,(t=>n(5,l=t))),s(t,pt,(t=>n(6,a=t)));let u=!1;S((()=>{Ct(et("websocket_url")),n(0,u=new URLSearchParams(window.location.search).get("debug"))}));return[u,o,r,c,i,l,a,()=>St("settings",{is_spectator:!1})]}class Te extends Q{constructor(t){super(),K(this,t,Be,Xe,c,{})}}function Le(t){let e,n;return e=new ct({}),{c(){H(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Fe(t){let e,n;return e=new Te({}),{c(){H(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Ue(e){let n,o,r,c;const i=[Fe,Le],s=[];return n=function(t,e){return t[0]?0:1}(e),o=s[n]=i[n](e),{c(){o.c(),r=m()},m(t,e){s[n].m(t,e),u(t,r,e),c=!0},p:t,i(t){c||(T(o),c=!0)},o(t){L(o),c=!1},d(t){t&&d(r),s[n].d(t)}}}function De(t){return[et("websocket_url")]}return new class extends Q{constructor(t){super(),K(this,t,De,Ue,c,{})}}({target:document.querySelector("#poker")})}();
